import{a as J}from"./chunk-TJQRFV6I.js";import{a as K}from"./chunk-JWAOZVIF.js";import{a as k,b as H}from"./chunk-NKQ37WB7.js";import{a as Q}from"./chunk-IRWBXMM3.js";import{a as E}from"./chunk-RQ3JBO34.js";import{a as U,b as g,c as A,d as D,e as G,i as M,j as O,k as R,l as V,m as $,n as z,o as q,q as j}from"./chunk-I5GBPY3C.js";import{b as B,d as P}from"./chunk-TRWNYS6K.js";import{h as w}from"./chunk-23D7R4XH.js";import{$a as m,G as _,Ka as d,Ma as l,Pa as y,Qa as o,Ra as i,Sa as s,Ua as C,Va as v,Y as p,_ as F,a as h,ab as N,b as x,bb as T,e as L,hb as I,jb as f,kb as S,wa as u,za as n}from"./chunk-27BBFG4U.js";var b=L(Q());function W(r,c){if(r&1&&(o(0,"div",7)(1,"div")(2,"div",24),s(3,"img",25),f(4,"image"),i()()()),r&2){let e=v();n(3),l("src",S(4,1,e.selectedEmployee.img,e.imagePipeTypeEmployees),u)}}function X(r,c){if(r&1&&(o(0,"option",26),m(1),i()),r&2){let e=c.$implicit;l("value",e._id),n(),T(" ",e.name," ")}}function Y(r,c){if(r&1&&(o(0,"div",1)(1,"div",2)(2,"div",3)(3,"h4",4),m(4,"Store"),i(),o(5,"h6",5),m(6),i(),o(7,"div",27),s(8,"img",28),f(9,"image"),i()()()()),r&2){let e=v();n(6),N(e.selectedStore.name),n(2),l("src",S(9,2,e.selectedStore.img,e.imagePipeTypeStores),u)}}var ve=(()=>{class r{fb=p(q);storeSvc=p(J);employeeSvc=p(K);router=p(P);activatedRoute=p(B);selectedEmployee;employeeForm=new G({});stores=[];selectedStore;imagePipeTypeEmployees=E.employees;imagePipeTypeStores=E.stores;ngOnInit(){this.activatedRoute.params.subscribe(({id:e})=>this.loadEmployee(e)),this.employeeForm=this.fb.group({name:["",g.required],store:["",g.required]}),this.loadStores(),this.employeeForm.get("store")?.valueChanges.subscribe({next:e=>{this.selectedStore=this.stores.find(t=>t._id===e)},error:e=>{console.error("Error",e)}})}loadEmployee(e){e!=="new"&&this.employeeSvc.getEmployeeById(e).pipe(_(100)).subscribe({next:t=>{this.selectedEmployee=t,this.employeeForm.setValue({name:t.name,store:t.store?t.store._id:null})},error:()=>{this.router.navigateByUrl("/dashboard/maintenances/employees")}})}loadStores(){this.storeSvc.loadStores().subscribe({next:e=>{this.stores=e},error:e=>{console.error("Error",e)}})}saveEmployee(){if(this.employeeForm.invalid)return;let{name:e}=this.employeeForm.value;if(this.selectedEmployee){let t=x(h({},this.employeeForm.value),{_id:this.selectedEmployee._id});this.employeeSvc.updateEmployee(t).subscribe(a=>{b.default.fire("Success",`Employee ${e} has been updated`,"success"),this.router.navigateByUrl(`/dashboard/maintenances/employee/${t._id}`)})}else this.employeeSvc.createEmployee(this.employeeForm.value).subscribe({next:t=>{console.log(t),b.default.fire("Success",`Employee ${e} has been created`,"success"),this.router.navigateByUrl(`/dashboard/maintenances/employee/${t.employee._id}`)},error:t=>{console.log(t)}})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=F({type:r,selectors:[["app-employee"]],standalone:!0,features:[I],decls:35,vars:5,consts:[[1,"row","mt-5"],[1,"col-md-6"],[1,"card"],[1,"card-body"],[1,"card-title","text-center"],[1,"card-subtitle","text-center"],[1,"form-horizontal",3,"submit","formGroup"],[1,"form-group","row","mt-3"],[1,"form-group","row","mt-4"],["for","exampleInputuname3",1,"col-sm-3","control-label","mt-1"],[1,"col-sm-9"],[1,"input-group"],["id","basic-addon1",1,"input-group-text"],[1,"fas","fa-user"],["type","text","formControlName","name","placeholder","Name of the employee","aria-label","Name","aria-describedby","basic-addon1",1,"form-control"],["for","exampleInputEmail3",1,"col-sm-3","control-label","my-1"],[1,"fas","fa-store"],["aria-label","Default select example","formControlName","store",1,"form-select"],["value","","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","row","mt-4","mb-2"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-secondary",3,"disabled"],[1,"fas","fa-save"],[1,"input-group","image-container"],["alt","",1,"avatar-header","cursor",3,"src"],[3,"value"],[1,"image-container","mt-3"],["alt","",1,"img-thumbnail","cursor",3,"src"]],template:function(t,a){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),m(5,"Employee"),i(),o(6,"h6",5),m(7,"Update Info"),i(),o(8,"form",6),C("submit",function(){return a.saveEmployee()}),d(9,W,5,4,"div",7),o(10,"div",8)(11,"label",9),m(12,"Name"),i(),o(13,"div",10)(14,"div",11)(15,"span",12),s(16,"i",13),i(),s(17,"input",14),i()()(),o(18,"div",7)(19,"label",15),m(20,"Store"),i(),o(21,"div",10)(22,"div",11)(23,"span",12),s(24,"i",16),i(),o(25,"select",17)(26,"option",18),m(27,"Select a Store"),i(),d(28,X,2,2,"option",19),i()()()(),o(29,"div",20)(30,"div",21)(31,"button",22),s(32,"i",23),m(33," \xA0 Save "),i()()()()()()(),d(34,Y,10,5,"div",1),i()),t&2&&(n(8),l("formGroup",a.employeeForm),n(),y(a.selectedEmployee?9:-1),n(19),l("ngForOf",a.stores),n(3),l("disabled",a.employeeForm.invalid),n(3),y(a.selectedStore?34:-1))},dependencies:[j,M,$,z,U,V,A,D,O,R,w,H,k]})}return r})();export{ve as EmployeeComponent};
