import{a as G}from"./chunk-GF7EUIHT.js";import{a as P}from"./chunk-OYQDOEY2.js";import{a as z}from"./chunk-IRWBXMM3.js";import{a as U}from"./chunk-RQ3JBO34.js";import{c as I,d as R,f as O,h as D,i as L,l as B,m as $,n as j,p as W}from"./chunk-I5GBPY3C.js";import{a as A}from"./chunk-22JHINBQ.js";import"./chunk-7NYZPO2S.js";import"./chunk-TRWNYS6K.js";import{h as F}from"./chunk-23D7R4XH.js";import{$a as r,G as b,Ka as g,Ma as S,Pa as h,Qa as t,Ra as i,Sa as y,Ta as x,Ua as d,Va as u,Y as f,_ as w,_a as C,ab as v,bb as T,db as V,e as q,eb as M,fb as k,ha as c,hb as N,ia as m,wa as E,za as a}from"./chunk-27BBFG4U.js";var _=q(z());function H(s,p){s&1&&(t(0,"div",7)(1,"div",2)(2,"div",9)(3,"h4",10),r(4,"Loading"),i(),t(5,"div",11)(6,"div",12)(7,"span",13),r(8,"Loading..."),i()()(),t(9,"p",14),r(10,"Please wait"),i()()()())}function J(s,p){s&1&&(t(0,"span",29),r(1,"Google"),i())}function K(s,p){s&1&&(t(0,"span",30),r(1,"Email"),i())}function Q(s,p){if(s&1){let e=x();t(0,"tr")(1,"td",20)(2,"img",24),d("click",function(){let o=c(e).$implicit,l=u(2);return m(l.openModal(o))}),i()(),t(3,"td",25),r(4),i(),t(5,"td",25),r(6),i(),t(7,"td",25)(8,"select",26),k("ngModelChange",function(o){let l=c(e).$implicit;return M(l.role,o)||(l.role=o),m(o)}),d("change",function(){let o=c(e).$implicit,l=u(2);return m(l.changeRole(o))}),t(9,"option",27),r(10,"Admin"),i(),t(11,"option",28),r(12,"User"),i()()(),t(13,"td",25),g(14,J,2,0,"span",29)(15,K,2,0,"span",30),i(),t(16,"td",31)(17,"a",32),d("click",function(){let o=c(e).$implicit,l=u(2);return m(l.deleteUser(o))}),y(18,"i",33),i()()()}if(s&2){let e=p.$implicit;a(2),S("src",e.imageUrl,E),a(2),v(e.email),a(2),v(e.name),a(2),V("ngModel",e.role),a(6),h(e.google?14:15)}}function X(s,p){if(s&1){let e=x();t(0,"button",34),d("click",function(){c(e);let o=u(2);return m(o.changeFrom(-5))}),r(1," Anteriores "),i(),r(2," \xA0 "),t(3,"button",34),d("click",function(){c(e);let o=u(2);return m(o.changeFrom(5))}),r(4," Siguientes "),i()}}function Z(s,p){if(s&1&&(t(0,"div",8)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h4",15),r(5),i(),t(6,"h6",16),r(7,"Registered users in the application"),i(),t(8,"div",17)(9,"table",18)(10,"thead")(11,"tr")(12,"th",19),r(13,"Avatar"),i(),t(14,"th",20),r(15,"Email"),i(),t(16,"th",20),r(17,"Name"),i(),t(18,"th",21),r(19,"Role"),i(),t(20,"th",19),r(21,"Auth"),i(),t(22,"th",22),r(23,"Actions"),i()()(),t(24,"tbody"),g(25,Q,19,5,"tr",23),i()()(),g(26,X,5,0),i()()()()),s&2){let e=u(),n=C(6);a(5),T("Total Users (",e.totalUsers,")"),a(20),S("ngForOf",e.users),a(),h(n.value.length===0?26:-1)}}var _e=(()=>{class s{userSvc=f(A);searchesSvc=f(P);imageModalSvc=f(G);loading=!0;users=[];tempUsers=[];imgSubs;totalUsers=0;from=0;ngOnInit(){this.getUsers(),this.imgSubs=this.imageModalSvc.newImage.pipe(b(100)).subscribe(e=>{this.getUsers()})}ngOnDestroy(){this.imgSubs.unsubscribe()}getUsers(){this.loading=!0,this.userSvc.loadUsers(this.from).subscribe(({total:e,users:n})=>{this.totalUsers=e,this.users=n,this.tempUsers=n,this.loading=!1})}changeFrom(e){this.from+=e,this.from<0?this.from=0:this.from>this.totalUsers&&(this.from-=e),this.getUsers()}search(e){if(e.length===0){this.users=this.tempUsers;return}this.searchesSvc.search(U.users,e).subscribe({next:n=>{this.users=n},error:n=>{console.log(n)}})}deleteUser(e){if(e.uid===this.userSvc.uid)return _.default.fire("Error","You can not delete yourself","error");_.default.fire({title:"Delete user?",text:`Is about to erase ${e.name}`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(n=>{n.isConfirmed&&this.userSvc.deleteUser(e).subscribe({next:()=>{_.default.fire("Deleted",`User ${e.name} deleted successfully`,"success"),this.getUsers()},error:o=>{_.default.fire("Error",o.error.msg,"error")}})})}changeRole(e){this.userSvc.saveUser(e).subscribe({next:()=>{_.default.fire("Updated","Role updated successfully","success")},error:n=>{_.default.fire("Error",n.error.msg,"error")}})}openModal(e){this.imageModalSvc.openModal(U.users,e.uid,e.img)}static \u0275fac=function(n){return new(n||s)};static \u0275cmp=w({type:s,selectors:[["app-users"]],standalone:!0,features:[N],decls:10,vars:1,consts:[["searchTerm",""],[1,"row","mt-4"],[1,"col-12"],[1,"card"],[1,"card-body"],["role","search",1,"d-flex"],["type","search","placeholder","Search User","aria-label","Search User",1,"form-control","me-2",3,"keyup"],[1,"row","animated","fadeIn","fast"],[1,"row"],[1,"alert","alert-dark","text-center"],[1,"alert-heading"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-grow","text-secondary"],[1,"visually-hidden"],[1,"mb-0"],[1,"card-title"],[1,"card-subtitle"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"w100","text-center"],[1,"text-center"],[1,"w140","text-center"],[1,"text-nowrap","w100","text-center"],[4,"ngFor","ngForOf"],["alt","user",1,"img-avatar","avatar","cursor",3,"click","src"],[1,"text-center","align-middle"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value","ADMIN_ROLE"],["value","USER_ROLE"],[1,"badge","bg-danger"],[1,"badge","bg-primary"],[1,"text-nowrap","d-flex","justify-content-evenly"],["data-toggle","tooltip","data-original-title","Delete",1,"cursor",3,"click"],[1,"fa","fa-close","text-danger","mt-3"],[1,"btn","btn-secondary",3,"click"]],template:function(n,o){if(n&1){let l=x();t(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"form",5)(5,"input",6,0),d("keyup",function(){c(l);let Y=C(6);return m(o.search(Y.value))}),i()()()()()(),r(7,`
\xA0 `),g(8,H,11,0,"div",7)(9,Z,27,3,"div",8)}n&2&&(a(8),h(o.loading?8:o.loading?-1:9))},dependencies:[F,W,L,$,j,B,I,R,D,O]})}return s})();export{_e as UsersComponent};
