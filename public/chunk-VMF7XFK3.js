import{a as z}from"./chunk-TJQRFV6I.js";import{a as q}from"./chunk-GF7EUIHT.js";import{a as U,b as Y}from"./chunk-NKQ37WB7.js";import{a as R}from"./chunk-OYQDOEY2.js";import{a as J}from"./chunk-IRWBXMM3.js";import{a as f}from"./chunk-RQ3JBO34.js";import{a as A,c as D,d as L,f as O,h as $,i as j,p as W}from"./chunk-I5GBPY3C.js";import"./chunk-7NYZPO2S.js";import{h as P}from"./chunk-23D7R4XH.js";import{$a as a,G as w,Ka as x,Ma as v,Pa as E,Qa as r,Ra as o,Sa as _,Ta as S,Ua as u,Va as d,Y as g,_ as b,_a as T,bb as M,db as V,e as H,eb as k,f as C,fb as N,ha as c,hb as B,ia as m,jb as F,kb as I,wa as y,za as p}from"./chunk-27BBFG4U.js";var l=H(J());function K(n,h){n&1&&(r(0,"div",7)(1,"div",2)(2,"div",9)(3,"h4",10),a(4,"Loading"),o(),r(5,"div",11)(6,"div",12)(7,"span",13),a(8,"Loading..."),o()()(),r(9,"p",14),a(10,"Please wait"),o()()()())}function Q(n,h){if(n&1){let e=S();r(0,"tr")(1,"td",26)(2,"img",29),F(3,"image"),u("click",function(){let i=c(e).$implicit,s=d(2);return m(s.openModal(i))}),o()(),r(4,"td",30)(5,"input",31),N("ngModelChange",function(i){let s=c(e).$implicit;return k(s.name,i)||(s.name=i),m(i)}),o()(),r(6,"td",32)(7,"a",33),u("click",function(){let i=c(e).$implicit,s=d(2);return m(s.saveChanges(i))}),_(8,"i",34),o(),r(9,"a",35),u("click",function(){let i=c(e).$implicit,s=d(2);return m(s.deleteStore(i))}),_(10,"i",36),o()()()}if(n&2){let e=h.$implicit,t=d(2);p(2),v("src",I(3,3,e.img,t.imagePipeType),y)("alt",e.name),p(3),V("ngModel",e.name)}}function X(n,h){if(n&1){let e=S();r(0,"div",8)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",15)(5,"div",16)(6,"h4",17),a(7),o(),r(8,"h6",18),a(9,"Registered stores in the application"),o()(),r(10,"div",19)(11,"div",20)(12,"button",21),u("click",function(){c(e);let i=d();return m(i.createStore())}),_(13,"i",22),a(14," \xA0 Create New Store "),o()()()(),r(15,"div",23)(16,"table",24)(17,"thead")(18,"tr")(19,"th",25),a(20,"Image"),o(),r(21,"th",26),a(22,"Name"),o(),r(23,"th",27),a(24,"Actions"),o()()(),r(25,"tbody"),x(26,Q,11,6,"tr",28),o()()()()()()()}if(n&2){let e=d();p(7),M("Total Stores (",e.stores.length,")"),p(19),v("ngForOf",e.stores)}}var _e=(()=>{class n{searchesSvc=g(R);storeSvc=g(z);imageModalSvc=g(q);imgSubs;loading=!0;stores=[];tempStores=[];totalStores=0;imagePipeType=f.stores;ngOnInit(){this.loadStores(),this.imgSubs=this.imageModalSvc.newImage.pipe(w(100)).subscribe(e=>{this.loadStores()})}ngOnDestroy(){this.imgSubs.unsubscribe()}search(e){if(e.length===0){this.stores=this.tempStores;return}this.searchesSvc.search(f.stores,e).subscribe({next:t=>{this.stores=t},error:t=>{console.log(t)}})}loadStores(){this.loading=!0,this.storeSvc.loadStores().subscribe({next:e=>{this.stores=e,this.tempStores=e,this.loading=!1},error:e=>{console.log(e)}})}saveChanges(e){e._id&&e.name?this.storeSvc.updateStore(e._id,e.name).subscribe({next:t=>{l.default.fire("Updated",e.name,"success")},error:t=>{l.default.fire("Error",t.error.msg,"error")}}):l.default.fire("Error","Store name is required","error")}deleteStore(e){l.default.fire({title:"Are you sure?",text:`You are going to delete ${e.name}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&this.storeSvc.deleteStore(e._id).subscribe({next:i=>{this.loadStores()},error:i=>{l.default.fire("Error",i.error.msg,"error")}})},t=>{console.log(t)})}createStore(){return C(this,null,function*(){let{value:e=""}=yield l.default.fire({title:"Create a new store",input:"text",inputLabel:"Enter store name",inputPlaceholder:"Name of the store",showCancelButton:!0,confirmButtonText:"Create",cancelButtonText:"Cancel",showLoaderOnConfirm:!0,preConfirm:t=>this.storeSvc.createStore(t).subscribe({next:i=>{this.loadStores()},error:i=>{l.default.showValidationMessage(`Request failed: ${i.error.msg}`)}})})})}openModal(e){console.log(e),this.imageModalSvc.openModal(f.stores,e._id,e.img)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=b({type:n,selectors:[["app-stores"]],standalone:!0,features:[B],decls:10,vars:1,consts:[["searchTerm",""],[1,"row","mt-4"],[1,"col-12"],[1,"card"],[1,"card-body"],["role","search",1,"d-flex"],["type","search","placeholder","Search Store","aria-label","Search Store",1,"form-control","me-2",3,"keyup"],[1,"row","animated","fadeIn","fast"],[1,"row"],[1,"alert","alert-dark","text-center"],[1,"alert-heading"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-grow","text-secondary"],[1,"visually-hidden"],[1,"mb-0"],[1,"row","mb-3"],[1,"col-8"],[1,"card-title"],[1,"card-subtitle"],[1,"col","mt-2"],[1,"d-grid","gap-2","d-md-flex","justify-content-md-end"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-store"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"w100","text-center"],[1,"text-center"],[1,"text-nowrap","w100","text-center"],[4,"ngFor","ngForOf"],[1,"avatar","cursor",3,"click","src","alt"],[1,"align-middle"],["type","text","placeholder","Store Name",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-nowrap","d-flex","justify-content-evenly"],["data-toggle","tooltip","data-original-title","Save Changes",1,"cursor",3,"click"],[1,"fa","fa-pencil","text-dark","mt-3"],["data-toggle","tooltip","data-original-title","Delete",1,"cursor",3,"click"],[1,"fa","fa-close","text-danger","mt-3"]],template:function(t,i){if(t&1){let s=S();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"form",5)(5,"input",6,0),u("keyup",function(){c(s);let G=T(6);return m(i.search(G.value))}),o()()()()()(),a(7,`
\xA0 `),x(8,K,11,0,"div",7)(9,X,27,2,"div",8)}t&2&&(p(8),E(i.loading?8:i.loading?-1:9))},dependencies:[P,W,j,A,D,L,$,O,Y,U]})}return n})();export{_e as StoresComponent};
